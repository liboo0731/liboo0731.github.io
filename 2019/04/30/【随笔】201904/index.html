<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="李博的博客">
    <meta name="keyword" content="striveliboo">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        【随笔】201904 - Liboo的博客 | Liboo&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Internet of Everything, Everywhere. </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            <i>H2K1E~ACE</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-24"><span class="toc-text">2019-04-24</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-23"><span class="toc-text">2019-04-23</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-22"><span class="toc-text">2019-04-22</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Blog创建规范"><span class="toc-text">Blog创建规范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-18"><span class="toc-text">2019-04-18</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Centos7-如何减少-home分区，扩大-root分区"><span class="toc-text">Centos7 如何减少/home分区，扩大/root分区</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-16"><span class="toc-text">2019-04-16</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量"><span class="toc-text">Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-11"><span class="toc-text">2019-04-11</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#命令学习"><span class="toc-text">命令学习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-10"><span class="toc-text">2019-04-10</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#防火墙简单使用"><span class="toc-text">防火墙简单使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#生成8位随机密码"><span class="toc-text">生成8位随机密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-08"><span class="toc-text">2019-04-08</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#部署脚本涉及"><span class="toc-text">部署脚本涉及</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux帮助使用"><span class="toc-text">Linux帮助使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-04"><span class="toc-text">2019-04-04</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux权限相关"><span class="toc-text">Linux权限相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建-删除用户"><span class="toc-text">创建/删除用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Shell变量"><span class="toc-text">Shell变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-03"><span class="toc-text">2019-04-03</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux添加永久静态路由的static-routes"><span class="toc-text">Linux添加永久静态路由的static-routes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文档存储"><span class="toc-text">文档存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip命令常用操作"><span class="toc-text">ip命令常用操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-02"><span class="toc-text">2019-04-02</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#异常-bin-sh-M-bad-interpreter-No-such-file-or-directory"><span class="toc-text">异常/bin/sh^M: bad interpreter: No such file or directory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#杂项"><span class="toc-text">杂项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#负载均衡"><span class="toc-text">负载均衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#net-tools-和-iproute2"><span class="toc-text">net-tools 和 iproute2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2019-04-01"><span class="toc-text">2019-04-01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-python标准库-存储对象（pickle、cPickle）"><span class="toc-text">1. python标准库-存储对象（pickle、cPickle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Ansible模块巩固"><span class="toc-text">2. Ansible模块巩固</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-磁盘分区"><span class="toc-text">3. 磁盘分区</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> Internet of Everything, Everywhere. </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        【随笔】201904
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-04-30 23:59:59</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#随笔" title="随笔">随笔</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#201904" title="201904">201904</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content ">
        <h2 id="2019-04-24"><a href="#2019-04-24" class="headerlink" title="2019-04-24"></a>2019-04-24</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">traceroute</span> (Windows系统下是tracert) 命令利用ICMP 协议定位您的计算机和目标计算机之间的所有路由器。<span class="meta">TTL</span>值可以反映数据包经过的路由器或网关的数量，通过操纵独立ICMP呼叫报文的<span class="meta">TTL</span>值和观察该报文被抛弃的返回信息，traceroute命令能够遍历到数据包传输路径上的所有路由器。traceroute是一条缓慢的命令，因为每经过一台路由器都要花去大约<span class="number">10</span>到<span class="number">15</span>秒。</span><br><span class="line"><span class="symbol">tracepath</span>命令 用来追踪并显示报文到达目的主机所经过的路由信息。</span><br><span class="line"><span class="symbol">ICMP</span>是“Internet Control Message Protocol”（Internet控制消息协议）的缩写。它是TCP/<span class="built_in">IP</span>协议族的一个子协议，用于在<span class="built_in">IP</span>主机、路由器之间传递控制消息。控制消息是指网络通不通、主机是否可达、路由是否可用等网络本身的消息。这些控制消息虽然并不传输用户数据，但是对于用户数据的传递起着重要的作用。</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-23"><a href="#2019-04-23" class="headerlink" title="2019-04-23"></a>2019-04-23</h2><p>sysctl命令用于运行时配置内核参数，这些参数位于/proc/sys目录下。sysctl配置与显示在/proc/sys目录中的内核参数．可以用sysctl来设置或重新设置联网功能，如IP转发、IP碎片去除以及源路由检查等。用户只需要编辑/etc/sysctl.conf文件，即可手工或自动执行由sysctl控制的功能。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">命令格式：</span><br><span class="line">sysctl [-n] [-e] -w variable=value</span><br><span class="line">sysctl [-n] [-e] -<span class="selector-tag">p</span> &lt;filename&gt; (default /etc/sysctl.conf)</span><br><span class="line">sysctl [-n] [-e] -a</span><br><span class="line"></span><br><span class="line">常用参数的意义：</span><br><span class="line">-w   临时改变某个指定参数的值，如 sysctl -w net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_forward</span>=<span class="number">1</span></span><br><span class="line">-<span class="selector-tag">a</span>   显示所有的系统参数</span><br><span class="line">-<span class="selector-tag">p</span>   从指定的文件加载系统参数，如不指定即从/etc/sysctl.conf中加载</span><br><span class="line"></span><br><span class="line">如果仅仅是想临时改变某个系统参数的值，可以用两种方法来实现,例如想启用IP路由转发功能：</span><br><span class="line"><span class="number">1</span>) <span class="selector-id">#echo</span> <span class="number">1</span> &gt; /proc/sys/net/ipv4/ip_forward</span><br><span class="line"><span class="number">2</span>) <span class="selector-id">#sysctl</span> -w net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_forward</span>=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">以上两种方法都可能立即开启路由功能，但如果系统重启，或执行了service network restart 命令，所设置的值即会丢失，如果想永久保留配置，可以修改/etc/sysctl.conf文件将 net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_forward</span>=<span class="number">0</span>改为net<span class="selector-class">.ipv4</span><span class="selector-class">.ip_forward</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="2019-04-22"><a href="#2019-04-22" class="headerlink" title="2019-04-22"></a>2019-04-22</h2><h3 id="Blog创建规范"><a href="#Blog创建规范" class="headerlink" title="Blog创建规范"></a>Blog创建规范</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>大分类：web、windows、linux、shell、python、openstack、tools、others、随笔、nfs、mysql、fastdfs、ansible</span><br><span class="line"><span class="bullet">2. </span>文件命名与blog标题一致，命名开头 eg: 【web】，标签第一个： web</span><br><span class="line"><span class="bullet">3. </span>从命名上分类，便于本地查看查找</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-18"><a href="#2019-04-18" class="headerlink" title="2019-04-18"></a>2019-04-18</h2><h3 id="Centos7-如何减少-home分区，扩大-root分区"><a href="#Centos7-如何减少-home分区，扩大-root分区" class="headerlink" title="Centos7 如何减少/home分区，扩大/root分区"></a>Centos7 如何减少/home分区，扩大/root分区</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">把/home内容备份，然后将/home文件系统所在的逻辑卷删除，扩大/root文件系统，新建/home：</span><br><span class="line">tar cvf /tmp/home.tar /home #备份/home</span><br><span class="line">umount /home #卸载/home，如果无法卸载，先终止使用/home文件系统的进程</span><br><span class="line">lvremove /dev/centos/home #删除/home所在的lv</span><br><span class="line">lvextend -L +50G /dev/centos/root #扩展/root所在的lv，增加50G</span><br><span class="line">xfs_growfs /dev/centos/root #扩展/root文件系统</span><br><span class="line">lvcreate -L 56G -n home centos #重新创建home lv</span><br><span class="line">mkfs.xfs /dev/centos/home #创建文件系统</span><br><span class="line">mount /dev/centos/home /home #挂载</span><br><span class="line">df -h</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-16"><a href="#2019-04-16" class="headerlink" title="2019-04-16"></a>2019-04-16</h2><h3 id="Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量"><a href="#Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量" class="headerlink" title="Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量"></a>Linux添加环境变量与GCC编译器添加INCLUDE与LIB环境变量</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">对所有用户有效在/etc/pro</span><br><span class="line"></span><br><span class="line">file增加以下内容。只对当前用户有效在Home目录下的</span><br><span class="line">.bashrc或.bash_profile 里增加下面的内容：</span><br><span class="line">(注意：等号前面不要加空格,否则可能出现 command not found)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">在PATH中找到可执行 文件程序的路径。</span></span><br><span class="line">export PATH =$PATH:$HOME/bin</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">gcc找到头文件的路径</span></span><br><span class="line">C_INCLUDE_PATH=/usr/include/libxml2:/MyLib</span><br><span class="line">export C_INCLUDE_PATH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">g++找到头文件的路径</span></span><br><span class="line">CPLUS_INCLUDE_PATH=$CPLUS_INCLUDE_PATH:/usr/include/libxml2:/MyLib</span><br><span class="line">export CPLUS_INCLUDE_PATH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">找到动态链接库的路径</span></span><br><span class="line">LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/MyLib </span><br><span class="line">export LD_LIBRARY_PATH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">找到静态库的路径</span></span><br><span class="line">LIBRARY_PATH=$LIBRARY_PATH:/MyLib</span><br><span class="line">export LIBRARY_PATH</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-11"><a href="#2019-04-11" class="headerlink" title="2019-04-11"></a>2019-04-11</h2><h3 id="命令学习"><a href="#命令学习" class="headerlink" title="命令学习"></a>命令学习</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">readlink</span><br><span class="line">输出符号链接值或者权威文件名</span><br><span class="line">英文为：</span><br><span class="line">print value of a symbolic link or canonical file name</span><br><span class="line">-f 选项：</span><br><span class="line">可以递归跟随给出文件名的所有符号链接以标准化，除最后一个外所有组件必须存在。</span><br><span class="line">简单地说，就是一直跟随符号链接，直到非符号链接的文件位置，限制是最后必须存在一个非符号链接的文件。</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">Absolute path to this script</span></span><br><span class="line">SCRIPT=$(readlink -f $0)</span><br><span class="line"><span class="meta">#</span><span class="bash">Absolute path this script is <span class="keyword">in</span></span></span><br><span class="line">SCRIPTPATH=$(dirname $SCRIPT)</span><br><span class="line">SCRIPTNAME=$(basename $SCRIPT)</span><br><span class="line">echo $0				setup.sh</span><br><span class="line">echo $SCRIPT		/home/admin/infoShare/setup.sh</span><br><span class="line">echo $SCRIPTPATH	/home/admin/infoShare</span><br><span class="line">echo $SCRIPTNAME	setup.sh</span><br><span class="line"></span><br><span class="line">dirname命令去除文件名中的非目录部分，仅显示与目录有关的内容。dirname命令读取指定路径名保留最后一个/及其后面的字符，删除其他部分，并写结果到标准输出。如果最后一个/后无字符，dirname 命令使用倒数第二个/，并忽略其后的所有字符。dirname 和 basename 通常在 shell 内部命令替换使用，以指定一个与指定输入文件名略有差异的输出文件名</span><br><span class="line"></span><br><span class="line">basename命令用于打印目录或者文件的基本名称。</span><br><span class="line"></span><br><span class="line">setfacl命令是用来在命令行里设置ACL（访问控制列表）。在命令行里，一系列的命令跟随以一系列的文件名。</span><br><span class="line">setfacl -m u:admin:wx /etc/systemd/system/multi-user.target.wants</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-10"><a href="#2019-04-10" class="headerlink" title="2019-04-10"></a>2019-04-10</h2><h3 id="防火墙简单使用"><a href="#防火墙简单使用" class="headerlink" title="防火墙简单使用"></a>防火墙简单使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">关闭已开放的端口</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">for port in `sudo firewall-cmd --list-ports`</span><br><span class="line">do</span><br><span class="line">echo "Close port $port"</span><br><span class="line">sudo firewall-cmd --permanent --zone=drop --remove-port=$port</span><br><span class="line">done</span><br><span class="line">sudo firewall-cmd --reload</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">完全隔离</span></span><br><span class="line">firewall-cmd --panic-on           Enable panic mode</span><br><span class="line">firewall-cmd --panic-off          Disable panic mode</span><br><span class="line">firewall-cmd --query-panic        Query whether panic mode is enabled</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">隔离外部访问，仅开放22端口</span></span><br><span class="line">firewall-cmd --set-default-zone=drop</span><br><span class="line">firewall-cmd --load-zone-defaults=drop --permanent</span><br><span class="line">firewall-cmd --permanent --zone=drop --add-port=22/tcp</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>
<h3 id="生成8位随机密码"><a href="#生成8位随机密码" class="headerlink" title="生成8位随机密码"></a>生成8位随机密码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MATRIX="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span><br><span class="line">LENGTH="8"</span><br><span class="line">while [ "$&#123;n:=1&#125;" -le "$LENGTH" ]</span><br><span class="line">do</span><br><span class="line">PASS="$PASS$&#123;MATRIX:$(($RANDOM%$&#123;#MATRIX&#125;)):1&#125;"</span><br><span class="line">let n+=1</span><br><span class="line">done</span><br><span class="line">echo $PASS</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-08"><a href="#2019-04-08" class="headerlink" title="2019-04-08"></a>2019-04-08</h2><h3 id="部署脚本涉及"><a href="#部署脚本涉及" class="headerlink" title="部署脚本涉及"></a>部署脚本涉及</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1. 新建特权用户</span><br><span class="line">useradd admin</span><br><span class="line">echo -e '123456<span class="tag">\<span class="name">n</span></span>123456' | passwd admin</span><br><span class="line">visudo</span><br><span class="line">admin localhost=NOPASSWD:/usr/bin/systemctl,/usr/bin/firewall-cmd,/sbin/reboot</span><br><span class="line">firewall-cmd --zone=public --permanent --add-port=80/tcp</span><br><span class="line">firewall-cmd --reload</span><br><span class="line">yum remove NetworkManager</span><br><span class="line">yum remove mariadb-libs</span><br><span class="line">2. 正则匹配</span><br><span class="line">正整数</span><br><span class="line">[1-9]<span class="tag">\<span class="name">d*</span></span></span><br><span class="line">IP地址</span><br><span class="line">(25[0-5]|2[0-4]<span class="tag">\<span class="name">d</span></span>|[0-1]<span class="tag">\<span class="name">d</span><span class="string">&#123;2&#125;</span></span>|[1-9]?<span class="tag">\<span class="name">d</span></span>)<span class="tag">\<span class="name">.</span></span>(25[0-5]|2[0-4]<span class="tag">\<span class="name">d</span></span>|[0-1]<span class="tag">\<span class="name">d</span><span class="string">&#123;2&#125;</span></span>|[1-9]?<span class="tag">\<span class="name">d</span></span>)<span class="tag">\<span class="name">.</span></span>(25[0-5]|2[0-4]<span class="tag">\<span class="name">d</span></span>|[0-1]<span class="tag">\<span class="name">d</span><span class="string">&#123;2&#125;</span></span>|[1-9]?<span class="tag">\<span class="name">d</span></span>)<span class="tag">\<span class="name">.</span></span>(25[0-5]|2[0-4]<span class="tag">\<span class="name">d</span></span>|[0-1]<span class="tag">\<span class="name">d</span><span class="string">&#123;2&#125;</span></span>|[1-9]?<span class="tag">\<span class="name">d</span></span>)</span><br><span class="line">(http|https)://(.*?):(.*?)/(.*)</span><br><span class="line">3. MySQL</span><br><span class="line">4. Redis</span><br><span class="line">5. FastDFS/S3</span><br><span class="line">6. lvs+keepalived</span><br><span class="line">7. infoShare</span><br></pre></td></tr></table></figure>
<h3 id="Linux帮助使用"><a href="#Linux帮助使用" class="headerlink" title="Linux帮助使用"></a>Linux帮助使用</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="selector-class">.whatis</span> </span><br><span class="line"><span class="number">2</span><span class="selector-class">.ls</span> --help </span><br><span class="line"><span class="number">3</span><span class="selector-class">.man</span> ls </span><br><span class="line"><span class="number">4</span><span class="selector-class">.info</span> ls </span><br><span class="line"><span class="number">5</span><span class="selector-class">.help</span> echo</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-04"><a href="#2019-04-04" class="headerlink" title="2019-04-04"></a>2019-04-04</h2><h3 id="Linux权限相关"><a href="#Linux权限相关" class="headerlink" title="Linux权限相关"></a>Linux权限相关</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">visudo</span><br><span class="line"><span class="keyword">chmod</span></span><br><span class="line"><span class="keyword">chown</span></span><br></pre></td></tr></table></figure>
<h3 id="创建-删除用户"><a href="#创建-删除用户" class="headerlink" title="创建/删除用户"></a>创建/删除用户</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">useradd</span>与<span class="keyword">adduser都是创建新的用户</span></span><br><span class="line"><span class="keyword">在CentOs下useradd与adduser是没有区别的都是在创建用户，在home下自动创建目录，没有设置密码，需要使用passwd命令修改密码。</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">而在Ubuntu下useradd与adduser有所不同</span></span><br><span class="line"><span class="keyword">1、useradd在使用该命令创建用户是不会在/home下自动创建与用户名同名的用户目录，而且不会自动选择shell版本，也没有设置密码，那么这个用户是不能登录的，需要使用passwd命令修改密码。</span></span><br><span class="line"><span class="keyword">2、adduser在使用该命令创建用户是会在/home下自动创建与用户名同名的用户目录，系统shell版本，会在创建时会提示输入密码，更加友好。</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">userdel </span>删除用户，</span><br><span class="line"><span class="symbol">userdel</span>只能删除用户，并不会删除相关的目录文件。userdel -r 可以删除用户及相关目录。</span><br></pre></td></tr></table></figure>
<h3 id="Shell变量"><a href="#Shell变量" class="headerlink" title="Shell变量"></a>Shell变量</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">变量说明<span class="symbol">:</span></span><br><span class="line"><span class="variable">$$</span></span><br><span class="line">Shell本身的PID（ProcessID）</span><br><span class="line"><span class="variable">$!</span></span><br><span class="line">Shell最后运行的后台Process的PID</span><br><span class="line"><span class="variable">$?</span></span><br><span class="line">最后运行的命令的结束代码（返回值）</span><br><span class="line"><span class="variable">$-</span></span><br><span class="line">使用Set命令设定的Flag一览</span><br><span class="line"><span class="variable">$*</span></span><br><span class="line">所有参数列表。如<span class="string">"$*"</span>用「<span class="string">"」括起来的情况、以"</span><span class="variable">$1</span> <span class="variable">$2</span> … <span class="variable">$n</span><span class="string">"的形式输出所有参数。</span></span><br><span class="line"><span class="string">$@</span></span><br><span class="line"><span class="string">所有参数列表。如"</span><span class="variable">$@</span><span class="string">"用「"</span>」括起来的情况、以<span class="string">"$1"</span> <span class="string">"$2"</span> … <span class="string">"$n"</span> 的形式输出所有参数。</span><br><span class="line"><span class="variable">$#</span></span><br><span class="line">添加到Shell的参数个数</span><br><span class="line"><span class="variable">$0</span></span><br><span class="line">Shell本身的文件名</span><br><span class="line"><span class="variable">$1</span>～<span class="variable">$n</span></span><br></pre></td></tr></table></figure>
<h2 id="2019-04-03"><a href="#2019-04-03" class="headerlink" title="2019-04-03"></a>2019-04-03</h2><h3 id="Linux添加永久静态路由的static-routes"><a href="#Linux添加永久静态路由的static-routes" class="headerlink" title="Linux添加永久静态路由的static-routes"></a>Linux添加永久静态路由的static-routes</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.在/etc/rc.local里添加</span></span><br><span class="line">方法： </span><br><span class="line">route add -net 192.168.3.0/24 dev eth0</span><br><span class="line">route add -net 192.168.2.0/24 gw 192.168.2.254</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.在/etc/sysconfig/network里添加到末尾</span></span><br><span class="line">方法：GATEWAY=gw-ip 或者 GATEWAY=gw-dev</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3./etc/sysconfig/static-routes : (没有static-routes的话就手动建立一个这样的文件)</span></span><br><span class="line">any net 192.168.3.0/24 gw 192.168.3.254</span><br><span class="line">any net 10.250.228.128 netmask 255.255.255.192 gw 10.250.228.129</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 4.开启 IP 转发：</span></span><br><span class="line">echo "1" &gt;/proc/sys/net/ipv4/ip_forward (临时)</span><br><span class="line">vi /etc/sysctl.conf --&gt; net.ipv4.ip_forward=1 (永久开启)</span><br></pre></td></tr></table></figure>
<h3 id="文档存储"><a href="#文档存储" class="headerlink" title="文档存储"></a>文档存储</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPS是<span class="keyword">XML</span> <span class="title">Paper</span> Specification的简称，它是微软公司开发的一种文档保存与查看的规范。</span><br></pre></td></tr></table></figure>
<h3 id="ip命令常用操作"><a href="#ip命令常用操作" class="headerlink" title="ip命令常用操作"></a>ip命令常用操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">ip地址管理</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示ip地址 </span></span><br><span class="line">ip a </span><br><span class="line">ip address show </span><br><span class="line">ip addr show dev eth0 </span><br><span class="line">ip a sh eth0</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 增加/删除地址</span></span><br><span class="line">ip address add 192.0.2.1/24 dev eth0 </span><br><span class="line">ip addr del 192.0.2.2/24 dev eth0</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示接口统计 </span></span><br><span class="line">ip -s link ls eth0</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">网卡和链路配置</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示链路 </span></span><br><span class="line">ip link show </span><br><span class="line">ip link sh eth0</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改接口状态 </span></span><br><span class="line">ip link set eth0 up</span><br><span class="line">ip link s gre01 down</span><br><span class="line"> </span><br><span class="line">路由表管理</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示路由表</span></span><br><span class="line">ip route</span><br><span class="line">ip ro show dev gre01</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 增加新路由</span></span><br><span class="line">ip route add 10.2.2.128/27 dev gre01</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 增加默认路由</span></span><br><span class="line">ip route add default via 192.168.1.1</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改默认路由</span></span><br><span class="line">ip route chg default via 192.168.1.2</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除默认路由</span></span><br><span class="line">ip route del default</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">隧道配置</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 增加删除GRE隧道</span></span><br><span class="line">ip tunnel add gre01 mode gre local 10.1.1.1 remote 20.2.2.1 ttl 255</span><br><span class="line">ip tunnel del gre01</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> IPIP隧道</span></span><br><span class="line">ip tunl a ipip01 mode ipip local 10.1.1.1 remote 20.2.2.1 ttl 255</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示隧道</span></span><br><span class="line">ip tunnel show</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示隧道统计</span></span><br><span class="line">ip -s tunl ls gre01</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">邻居和arp表管理</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看arp表</span></span><br><span class="line">ip neigh show</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 手工增加删除arp项</span></span><br><span class="line">ip neighbor add 10.2.2.2 dev eth0</span><br><span class="line">ip neigh del 10.2.2.1 dev eth0</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">socket统计</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示当前监听</span></span><br><span class="line">ss -l</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示当前监听的进程</span></span><br><span class="line">ss -p</span><br><span class="line">  </span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 常用命令</span></span><br><span class="line">ip link show #显示链路</span><br><span class="line">ip addr show #显示地址(或ifconfig)</span><br><span class="line">ip route show #显示路由(route -n)</span><br><span class="line">ip neigh show #显示arp表(ping 192.168.95.50，如果主机在同一局域网内，直接加到arp表)</span><br><span class="line">ip neigh delete 192.168.95.50 dev eth0 #删除arp条目，条目仍然存在状态为stale，下次通信需要确认</span><br><span class="line">ip rule show #显示缺省规则</span><br><span class="line">ip route del default dev eth0 #删除接口路由</span><br><span class="line">ip route show table local #查看本地静态路由</span><br><span class="line">ip route show table main #查看直连路由</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加静态路由 </span></span><br><span class="line">ip route add 10.0.0.0/24 via 192.168.92.129</span><br><span class="line">ip route add 10.10.10.10 via 192.168.92.129</span><br><span class="line">ip route add 172.31.100.0/24 dev eth0</span><br><span class="line">ip route add 172.32.0.2 dev eth0</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看路由表 </span></span><br><span class="line">ip route show table main</span><br><span class="line">ip route show table local </span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除</span></span><br><span class="line">ip route del 10.0.0.0/24 </span><br><span class="line">ip route del 10.10.10.10   </span><br><span class="line">ip route del 172.31.100.0/24</span><br><span class="line">ip route del 172.32.0.2 </span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加网卡别名并添加标记 label </span></span><br><span class="line">ip addr add 192.168.1.2/24 label eth0:0 dev eth0</span><br><span class="line">ip addr show eth0</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-02"><a href="#2019-04-02" class="headerlink" title="2019-04-02"></a>2019-04-02</h2><h3 id="异常-bin-sh-M-bad-interpreter-No-such-file-or-directory"><a href="#异常-bin-sh-M-bad-interpreter-No-such-file-or-directory" class="headerlink" title="异常/bin/sh^M: bad interpreter: No such file or directory"></a>异常/bin/sh^M: bad interpreter: No such file or directory</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">在Linux中执行.sh脚本，异常/bin/sh^M: bad interpreter: No such file or directory。 </span><br><span class="line"></span><br><span class="line">分析：</span><br><span class="line">这是不同系统编码格式引起的：在windows系统中编辑的.sh文件可能有不可见字符，所以在Linux系统下执行会报以上异常信息。 </span><br><span class="line">解决：</span><br><span class="line">1）在windows下转换： </span><br><span class="line">利用一些编辑器如UltraEdit或EditPlus等工具先将脚本编码转换，再放到Linux中执行。转换方式如下（UltraEdit）：File--&gt;Conversions--&gt;DOS-&gt;UNIX即可。 </span><br><span class="line">2）也可在Linux中转换： </span><br><span class="line">首先要确保文件有可执行权限 </span><br><span class="line"><span class="meta">#</span><span class="bash">sh&gt;chmod a+x filename </span></span><br><span class="line"></span><br><span class="line">然后修改文件格式 </span><br><span class="line"><span class="meta">#</span><span class="bash">sh&gt;vi filename </span></span><br><span class="line"></span><br><span class="line">利用如下命令查看文件格式 </span><br><span class="line">:set ff 或 :set fileformat </span><br><span class="line"></span><br><span class="line">可以看到如下信息 </span><br><span class="line">fileformat=dos 或 fileformat=unix </span><br><span class="line"></span><br><span class="line">利用如下命令修改文件格式 </span><br><span class="line">:set ff=unix 或 :set fileformat=unix </span><br><span class="line"></span><br><span class="line">:wq (存盘退出) </span><br><span class="line"></span><br><span class="line">最后再执行文件 </span><br><span class="line"><span class="meta">#</span><span class="bash">sh&gt;./filename</span></span><br></pre></td></tr></table></figure>
<h3 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Chromium Embedded Framework (CEF) 是一个开源项目，用于嵌入基于 Google Chromium 项目的 Web 浏览器控件。</span><br><span class="line">pywebview 是一个轻量级跨平台的 HTML 浏览器控件，可以在 GUI 应用中显示 HTML 内容。</span><br><span class="line"><span class="symbol">https:</span><span class="comment">//pywebview.flowrl.com/</span></span><br></pre></td></tr></table></figure>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>DNS解析</span><br><span class="line"><span class="bullet">2. </span>Nginx反向代理</span><br><span class="line"><span class="bullet">3. </span>lvs+keepalive</span><br></pre></td></tr></table></figure>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ifconfig lo:<span class="number">0</span> <span class="number">125.12</span><span class="meta">.12</span><span class="meta">.77</span> broadcast125<span class="meta">.12</span><span class="meta">.12</span><span class="meta">.77</span> netmask <span class="number">255.255</span><span class="meta">.255</span><span class="meta">.255</span> <span class="meta">up</span></span><br><span class="line"></span><br><span class="line">route <span class="keyword">add</span> -host <span class="number">125.12</span><span class="meta">.12</span><span class="meta">.77</span> dev lo:<span class="number">0</span></span><br><span class="line"></span><br><span class="line">netmask原意是用于分割子网网络号和子网主机号，所以大部分私有网络（如家庭网络或企业网络）会按需配置或默认的<span class="number">255.255</span><span class="meta">.255</span><span class="meta">.0</span>（表示该子网能容纳<span class="number">255</span>个主机）。在上例中，这个虚拟<span class="built_in">ip</span>显然不需要配置子网，所以设为<span class="number">4</span>个<span class="number">255</span>表示无子网是自然、合理的。（末尾的<span class="meta">up</span>表示update）</span><br><span class="line"></span><br><span class="line">这段代码的意图是避免多台RealServer设定了相同的虚拟<span class="built_in">ip</span>之后导致<span class="built_in">ip</span>冲突，我猜测：</span><br><span class="line"></span><br><span class="line">广播地址设为自己的<span class="built_in">ip</span>，用于收到同<span class="built_in">ip</span>发来的消息时，让系统误认为是广播消息（因此系统不觉得<span class="built_in">ip</span>冲突）</span><br><span class="line">向路由表加规则，用于向同<span class="built_in">ip</span>发出消息时，被发送的消息将进入环回接口，即只有该主机自己能收到，不会向网络扩散。</span><br><span class="line"></span><br><span class="line">结论：</span><br><span class="line">掩码设为<span class="number">4</span>个<span class="number">255</span>与防止<span class="built_in">ip</span>冲突无关。</span><br><span class="line"></span><br><span class="line">参考：</span><br><span class="line"><span class="symbol">http:</span>//os.51cto.com/art/<span class="number">201105</span>/<span class="number">264303.</span>htm</span><br><span class="line"><span class="symbol">http:</span>//os.51cto.com/art/<span class="number">201105</span>/<span class="number">262536.</span>htm</span><br></pre></td></tr></table></figure>
<h3 id="net-tools-和-iproute2"><a href="#net-tools-和-iproute2" class="headerlink" title="net-tools 和 iproute2"></a>net-tools 和 iproute2</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line">nettools（ifconfig、route、arp和netstat）</span><br><span class="line"><span class="meta">#</span><span class="bash"> ifconfig</span></span><br><span class="line">Usage:</span><br><span class="line">  ifconfig [-a] [-v] [-s] &lt;interface&gt; [[&lt;AF&gt;] &lt;address&gt;]</span><br><span class="line">  [add &lt;address&gt;[/&lt;prefixlen&gt;]]</span><br><span class="line">  [del &lt;address&gt;[/&lt;prefixlen&gt;]]</span><br><span class="line">  [[-]broadcast [&lt;address&gt;]]  [[-]pointopoint [&lt;address&gt;]]</span><br><span class="line">  [netmask &lt;address&gt;]  [dstaddr &lt;address&gt;]  [tunnel &lt;address&gt;]</span><br><span class="line">  [outfill &lt;NN&gt;] [keepalive &lt;NN&gt;]</span><br><span class="line">  [hw &lt;HW&gt; &lt;address&gt;]  [mtu &lt;NN&gt;]</span><br><span class="line">  [[-]trailers]  [[-]arp]  [[-]allmulti]</span><br><span class="line">  [multicast]  [[-]promisc]</span><br><span class="line">  [mem_start &lt;NN&gt;]  [io_addr &lt;NN&gt;]  [irq &lt;NN&gt;]  [media &lt;type&gt;]</span><br><span class="line">  [txqueuelen &lt;NN&gt;]</span><br><span class="line">  [[-]dynamic]</span><br><span class="line">  [up|down] ...</span><br><span class="line"></span><br><span class="line">  &lt;HW&gt;=Hardware Type.</span><br><span class="line">  List of possible hardware types:</span><br><span class="line">    loop (Local Loopback) slip (Serial Line IP) cslip (VJ Serial Line IP) </span><br><span class="line">    slip6 (6-bit Serial Line IP) cslip6 (VJ 6-bit Serial Line IP) adaptive (Adaptive Serial Line IP) </span><br><span class="line">    ash (Ash) ether (Ethernet) ax25 (AMPR AX.25) </span><br><span class="line">    netrom (AMPR NET/ROM) rose (AMPR ROSE) tunnel (IPIP Tunnel) </span><br><span class="line">    ppp (Point-to-Point Protocol) hdlc ((Cisco)-HDLC) lapb (LAPB) </span><br><span class="line">    arcnet (ARCnet) dlci (Frame Relay DLCI) frad (Frame Relay Access Device) </span><br><span class="line">    sit (IPv6-in-IPv4) fddi (Fiber Distributed Data Interface) hippi (HIPPI) </span><br><span class="line">    irda (IrLAP) ec (Econet) x25 (generic X.25) </span><br><span class="line">    infiniband (InfiniBand) eui64 (Generic EUI-64) </span><br><span class="line">  &lt;AF&gt;=Address family. Default: inet</span><br><span class="line">  List of possible address families:</span><br><span class="line">    unix (UNIX Domain) inet (DARPA Internet) inet6 (IPv6) </span><br><span class="line">    ax25 (AMPR AX.25) netrom (AMPR NET/ROM) rose (AMPR ROSE) </span><br><span class="line">    ipx (Novell IPX) ddp (Appletalk DDP) ec (Econet) </span><br><span class="line">    ash (Ash) x25 (CCITT X.25)</span><br><span class="line">    </span><br><span class="line"><span class="meta">#</span><span class="bash"> route</span></span><br><span class="line">Usage: route [-nNvee] [-FC] [&lt;AF&gt;]           List kernel routing tables</span><br><span class="line">       route [-v] [-FC] &#123;add|del|flush&#125; ...  Modify routing table for AF.</span><br><span class="line"></span><br><span class="line">       route &#123;-h|--help&#125; [&lt;AF&gt;]              Detailed usage syntax for specified AF.</span><br><span class="line">       route &#123;-V|--version&#125;                  Display version/author and exit.</span><br><span class="line"></span><br><span class="line">        -v, --verbose            be verbose</span><br><span class="line">        -n, --numeric            don't resolve names</span><br><span class="line">        -e, --extend             display other/more information</span><br><span class="line">        -F, --fib                display Forwarding Information Base (default)</span><br><span class="line">        -C, --cache              display routing cache instead of FIB</span><br><span class="line"></span><br><span class="line">  &lt;AF&gt;=Use -4, -6, '-A &lt;af&gt;' or '--&lt;af&gt;'; default: inet</span><br><span class="line">  List of possible address families (which support routing):</span><br><span class="line">    inet (DARPA Internet) inet6 (IPv6) ax25 (AMPR AX.25) </span><br><span class="line">    netrom (AMPR NET/ROM) ipx (Novell IPX) ddp (Appletalk DDP) </span><br><span class="line">    x25 (CCITT X.25) </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> netstat</span></span><br><span class="line">usage: netstat [-vWeenNcCF] [&lt;Af&gt;] -r         netstat &#123;-V|--version|-h|--help&#125;</span><br><span class="line">       netstat [-vWnNcaeol] [&lt;Socket&gt; ...]</span><br><span class="line">       netstat &#123; [-vWeenNac] -I[&lt;Iface&gt;] | [-veenNac] -i | [-cnNe] -M | -s [-6tuw] &#125; [delay]</span><br><span class="line"></span><br><span class="line">        -r, --route              display routing table</span><br><span class="line">        -I, --interfaces=&lt;Iface&gt; display interface table for &lt;Iface&gt;</span><br><span class="line">        -i, --interfaces         display interface table</span><br><span class="line">        -g, --groups             display multicast group memberships</span><br><span class="line">        -s, --statistics         display networking statistics (like SNMP)</span><br><span class="line">        -M, --masquerade         display masqueraded connections</span><br><span class="line"></span><br><span class="line">        -v, --verbose            be verbose</span><br><span class="line">        -W, --wide               don't truncate IP addresses</span><br><span class="line">        -n, --numeric            don't resolve names</span><br><span class="line">        --numeric-hosts          don't resolve host names</span><br><span class="line">        --numeric-ports          don't resolve port names</span><br><span class="line">        --numeric-users          don't resolve user names</span><br><span class="line">        -N, --symbolic           resolve hardware names</span><br><span class="line">        -e, --extend             display other/more information</span><br><span class="line">        -p, --programs           display PID/Program name for sockets</span><br><span class="line">        -o, --timers             display timers</span><br><span class="line">        -c, --continuous         continuous listing</span><br><span class="line"></span><br><span class="line">        -l, --listening          display listening server sockets</span><br><span class="line">        -a, --all                display all sockets (default: connected)</span><br><span class="line">        -F, --fib                display Forwarding Information Base (default)</span><br><span class="line">        -C, --cache              display routing cache instead of FIB</span><br><span class="line">        -Z, --context            display SELinux security context for sockets</span><br><span class="line"></span><br><span class="line">  &lt;Socket&gt;=&#123;-t|--tcp&#125; &#123;-u|--udp&#125; &#123;-U|--udplite&#125; &#123;-S|--sctp&#125; &#123;-w|--raw&#125;</span><br><span class="line">           &#123;-x|--unix&#125; --ax25 --ipx --netrom</span><br><span class="line">  &lt;AF&gt;=Use '-6|-4' or '-A &lt;af&gt;' or '--&lt;af&gt;'; default: inet</span><br><span class="line">  List of possible address families (which support routing):</span><br><span class="line">    inet (DARPA Internet) inet6 (IPv6) ax25 (AMPR AX.25) </span><br><span class="line">    netrom (AMPR NET/ROM) ipx (Novell IPX) ddp (Appletalk DDP) </span><br><span class="line">    x25 (CCITT X.25)</span><br><span class="line">    </span><br><span class="line"><span class="meta">#</span><span class="bash"> arp</span></span><br><span class="line">Usage:</span><br><span class="line">  arp [-vn]  [&lt;HW&gt;] [-i &lt;if&gt;] [-a] [&lt;hostname&gt;]             &lt;-Display ARP cache</span><br><span class="line">  arp [-v]          [-i &lt;if&gt;] -d  &lt;host&gt; [pub]               &lt;-Delete ARP entry</span><br><span class="line">  arp [-vnD] [&lt;HW&gt;] [-i &lt;if&gt;] -f  [&lt;filename&gt;]            &lt;-Add entry from file</span><br><span class="line">  arp [-v]   [&lt;HW&gt;] [-i &lt;if&gt;] -s  &lt;host&gt; &lt;hwaddr&gt; [temp]            &lt;-Add entry</span><br><span class="line">  arp [-v]   [&lt;HW&gt;] [-i &lt;if&gt;] -Ds &lt;host&gt; &lt;if&gt; [netmask &lt;nm&gt;] pub          &lt;-''-</span><br><span class="line"></span><br><span class="line">        -a                       display (all) hosts in alternative (BSD) style</span><br><span class="line">        -e                       display (all) hosts in default (Linux) style</span><br><span class="line">        -s, --set                set a new ARP entry</span><br><span class="line">        -d, --delete             delete a specified entry</span><br><span class="line">        -v, --verbose            be verbose</span><br><span class="line">        -n, --numeric            don't resolve names</span><br><span class="line">        -i, --device             specify network interface (e.g. eth0)</span><br><span class="line">        -D, --use-device         read &lt;hwaddr&gt; from given device</span><br><span class="line">        -A, -p, --protocol       specify protocol family</span><br><span class="line">        -f, --file               read new entries from file or from /etc/ethers</span><br><span class="line"></span><br><span class="line">  &lt;HW&gt;=Use '-H &lt;hw&gt;' to specify hardware address type. Default: ether</span><br><span class="line">  List of possible hardware types (which support ARP):</span><br><span class="line">    ash (Ash) ether (Ethernet) ax25 (AMPR AX.25) </span><br><span class="line">    netrom (AMPR NET/ROM) rose (AMPR ROSE) arcnet (ARCnet) </span><br><span class="line">    dlci (Frame Relay DLCI) fddi (Fiber Distributed Data Interface) hippi (HIPPI) </span><br><span class="line">    irda (IrLAP) x25 (generic X.25) infiniband (InfiniBand) </span><br><span class="line">    eui64 (Generic EUI-64)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">iproute2（ip和ss）</span><br><span class="line"><span class="meta">#</span><span class="bash"> ip</span></span><br><span class="line">Usage: ip [ OPTIONS ] OBJECT &#123; COMMAND | help &#125;</span><br><span class="line">       ip [ -force ] -batch filename</span><br><span class="line">where  OBJECT := &#123; link | address | addrlabel | route | rule | neigh | ntable |</span><br><span class="line">                   tunnel | tuntap | maddress | mroute | mrule | monitor | xfrm |</span><br><span class="line">                   netns | l2tp | macsec | tcp_metrics | token &#125;</span><br><span class="line">       OPTIONS := &#123; -V[ersion] | -s[tatistics] | -d[etails] | -r[esolve] |</span><br><span class="line">                    -h[uman-readable] | -iec |</span><br><span class="line">                    -f[amily] &#123; inet | inet6 | ipx | dnet | bridge | link &#125; |</span><br><span class="line">                    -4 | -6 | -I | -D | -B | -0 |</span><br><span class="line">                    -l[oops] &#123; maximum-addr-flush-attempts &#125; |</span><br><span class="line">                    -o[neline] | -t[imestamp] | -ts[hort] | -b[atch] [filename] |</span><br><span class="line">                    -rc[vbuf] [size] | -n[etns] name | -a[ll] &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ss</span></span><br><span class="line">Usage: ss [ OPTIONS ]</span><br><span class="line">       ss [ OPTIONS ] [ FILTER ]</span><br><span class="line">   -h, --help          this message</span><br><span class="line">   -V, --version       output version information</span><br><span class="line">   -n, --numeric       don't resolve service names</span><br><span class="line">   -r, --resolve       resolve host names</span><br><span class="line">   -a, --all           display all sockets</span><br><span class="line">   -l, --listening     display listening sockets</span><br><span class="line">   -o, --options       show timer information</span><br><span class="line">   -e, --extended      show detailed socket information</span><br><span class="line">   -m, --memory        show socket memory usage</span><br><span class="line">   -p, --processes     show process using socket</span><br><span class="line">   -i, --info          show internal TCP information</span><br><span class="line">   -s, --summary       show socket usage summary</span><br><span class="line">   -b, --bpf           show bpf filter socket information</span><br><span class="line">   -Z, --context       display process SELinux security contexts</span><br><span class="line">   -z, --contexts      display process and socket SELinux security contexts</span><br><span class="line">   -N, --net           switch to the specified network namespace name</span><br><span class="line"></span><br><span class="line">   -4, --ipv4          display only IP version 4 sockets</span><br><span class="line">   -6, --ipv6          display only IP version 6 sockets</span><br><span class="line">   -0, --packet        display PACKET sockets</span><br><span class="line">   -t, --tcp           display only TCP sockets</span><br><span class="line">   -S, --sctp          display only SCTP sockets</span><br><span class="line">   -u, --udp           display only UDP sockets</span><br><span class="line">   -d, --dccp          display only DCCP sockets</span><br><span class="line">   -w, --raw           display only RAW sockets</span><br><span class="line">   -x, --unix          display only Unix domain sockets</span><br><span class="line">   -f, --family=FAMILY display sockets of type FAMILY</span><br><span class="line"></span><br><span class="line">   -A, --query=QUERY, --socket=QUERY</span><br><span class="line">       QUERY := &#123;all|inet|tcp|udp|raw|unix|unix_dgram|unix_stream|unix_seqpacket|packet|netlink&#125;[,QUERY]</span><br><span class="line"></span><br><span class="line">   -D, --diag=FILE     Dump raw information about TCP sockets to FILE</span><br><span class="line">   -F, --filter=FILE   read filter information from FILE</span><br><span class="line">       FILTER := [ state STATE-FILTER ] [ EXPRESSION ]</span><br><span class="line">       STATE-FILTER := &#123;all|connected|synchronized|bucket|big|TCP-STATES&#125;</span><br><span class="line">         TCP-STATES := &#123;established|syn-sent|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|closed|close-wait|last-ack|listen|closing&#125;</span><br><span class="line">          connected := &#123;established|syn-sent|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|close-wait|last-ack|closing&#125;</span><br><span class="line">       synchronized := &#123;established|syn-recv|fin-wait-&#123;1,2&#125;|time-wait|close-wait|last-ack|closing&#125;</span><br><span class="line">             bucket := &#123;syn-recv|time-wait&#125;</span><br><span class="line">                big := &#123;established|syn-sent|fin-wait-&#123;1,2&#125;|closed|close-wait|last-ack|listen|closing&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2019-04-01"><a href="#2019-04-01" class="headerlink" title="2019-04-01"></a>2019-04-01</h2><h3 id="1-python标准库-存储对象（pickle、cPickle）"><a href="#1-python标准库-存储对象（pickle、cPickle）" class="headerlink" title="1. python标准库-存储对象（pickle、cPickle）"></a>1. python标准库-存储对象（pickle、cPickle）</h3><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">当<span class="type">Python</span>运行时，对象存储在内存中，随时等待系统的调用。然而，内存里的数据会随着计算机关机和消失，如何将对象保存到文件，并储存在硬盘上呢？</span><br><span class="line">计算机的内存中存储的是二进制的序列 (当然，在<span class="type">Linux</span>眼中，是文本流)。我们可以直接将某个对象所对应位置的数据抓取下来，转换成文本流 (这个过程叫做serialize)，然后将文本流存入到文件中。由于<span class="type">Python</span>在创建对象时，要参考对象的类定义，所以当我们从文本中读取对象时，必须在手边要有该对象的类定义，才能懂得如何去重建这一对象。从文件读取时，对于<span class="type">Python</span>的内建(built-<span class="keyword">in</span>)对象 (比如说整数、词典、表等等)，由于其类定义已经载入内存，所以不需要我们再在程序中定义类。但对于用户自行定义的对象，就必须要先定义类，然后才能从文件中载入对象。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="meta"># 1) 将内存中的对象转换成为文本流（序列化）：</span></span><br><span class="line"><span class="title">pickle</span>.dumps() <span class="comment">-- 对象转换为字符串，接着存储文本文件</span></span><br><span class="line"><span class="title">pickle</span>.dump() <span class="comment">-- 可同时完成上述两步操作</span></span><br><span class="line"><span class="meta"># 2) 重建对象（反序列化）：</span></span><br><span class="line"><span class="title">pickle</span>.load()</span><br><span class="line"><span class="title">pickle</span>.loads()</span><br><span class="line"></span><br><span class="line"><span class="title">cPickle</span>包的功能和用法与pickle包几乎完全相同，不同在于cPickle是基于c语言编写的，速度是pickle包的<span class="number">1000</span>倍。</span><br><span class="line"><span class="keyword">import</span> cPickle <span class="keyword">as</span> pickle</span><br></pre></td></tr></table></figure>
<h3 id="2-Ansible模块巩固"><a href="#2-Ansible模块巩固" class="headerlink" title="2. Ansible模块巩固"></a>2. Ansible模块巩固</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">1）主机连通性测试</span><br><span class="line">ansible web -m ping</span><br><span class="line"></span><br><span class="line">2）command 模块</span><br><span class="line">直接在远程主机上执行命令，并将结果返回本主机。</span><br><span class="line">ansible web -m command -a 'ss -ntl'</span><br><span class="line"></span><br><span class="line">3）shell 模块</span><br><span class="line">在远程主机上调用shell解释器运行命令</span><br><span class="line">ansible web -m shell -a 'cat /etc/passwd |grep "fdfs"'</span><br><span class="line"></span><br><span class="line">4）copy 模块</span><br><span class="line">用于将文件复制到远程主机，同时支持给定内容生成文件和修改权限等。</span><br><span class="line">ansible web -m copy -a 'src=~/hello dest=/data/hello' </span><br><span class="line"></span><br><span class="line">5）file 模块</span><br><span class="line">主要用于设置文件的属性，比如创建文件、创建链接文件、删除文件等。</span><br><span class="line">ansible web -m file -a 'path=/data/app state=directory'</span><br><span class="line"></span><br><span class="line">6）fetch 模块</span><br><span class="line">用于从远程某主机获取（复制）文件到本地。</span><br><span class="line">ansible web -m fetch -a 'src=/data/hello dest=/data'  </span><br><span class="line"></span><br><span class="line">7）cron 模块</span><br><span class="line">用于管理cron计划任务的。其使用的语法跟我们的crontab文件中的语法一致。</span><br><span class="line">ansible web -m cron -a 'name="ntp update every 5 min" minute=*/5 job="/sbin/ntpdate 172.17.0.1 &amp;&gt; /dev/null"'</span><br><span class="line"> </span><br><span class="line">8）yum 模块</span><br><span class="line">用于软件的安装。</span><br><span class="line">ansible web -m yum -a 'name=htop state=present'</span><br><span class="line"></span><br><span class="line">9）service 模块</span><br><span class="line">用于服务程序的管理。</span><br><span class="line">ansible web -m service -a 'name=nginx state=started enabled=true' </span><br><span class="line"></span><br><span class="line">10）user 模块</span><br><span class="line">用来管理用户账号。</span><br><span class="line">ansible web -m user -a 'name=fdfs uid=11111'</span><br><span class="line"></span><br><span class="line">11）group 模块</span><br><span class="line">用于添加或删除组。</span><br><span class="line">ansible web -m group -a 'name=ops gid=12222'</span><br><span class="line"></span><br><span class="line">12）script 模块</span><br><span class="line">用于将本机的脚本在被管理端的机器上运行。</span><br><span class="line">ansible web -m script -a '/tmp/df.sh'</span><br><span class="line"></span><br><span class="line">13）setup 模块</span><br><span class="line">用于收集信息，是通过调用facts组件来实现的。</span><br><span class="line">facts组件是Ansible用于采集被管机器设备信息的一个功能，我们可以使用setup模块查机器的所有facts信息，可以使用filter来查看指定信息。整个facts信息被包装在一个JSON格式的数据结构中，ansible_facts是最上层的值。</span><br><span class="line">facts就是变量，内建变量 。每个主机的各种信息，cpu颗数、内存大小等。会存在facts中的某个变量中。调用后返回很多对应主机的信息，在后面的操作中可以根据不同的信息来做不同的操作。</span><br><span class="line">ansible web -m setup -a 'filter="*mem*"'</span><br></pre></td></tr></table></figure>
<h3 id="3-磁盘分区"><a href="#3-磁盘分区" class="headerlink" title="3. 磁盘分区"></a>3. 磁盘分区</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">disk=`fdisk -l | grep "Disk /dev/sd[a-z]"`</span><br><span class="line">for i in `ls /dev/[sh]d[a-z]`;do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br><span class="line">diskpart() &#123;</span><br><span class="line">dd if=/dev/zero of=/dev/$chof bs=600 count=1</span><br><span class="line">echo 'n</span><br><span class="line">p</span><br><span class="line">1</span><br><span class="line">+512M</span><br><span class="line">n</span><br><span class="line">p</span><br><span class="line">2</span><br><span class="line">+512M</span><br><span class="line">n</span><br><span class="line">p</span><br><span class="line">3</span><br><span class="line">+2G</span><br><span class="line">t</span><br><span class="line">2</span><br><span class="line">82</span><br><span class="line">w</span><br><span class="line">' | fdisk $chof</span><br><span class="line">&#125;</span><br><span class="line">Mount() &#123;</span><br><span class="line">num=`grep "$chof" /etc/mtab | wc -l`</span><br><span class="line">for k in `seq $[$num+1]` ;do</span><br><span class="line">        fuser -km $chof$k</span><br><span class="line">        umount $chof$k</span><br><span class="line">        done</span><br><span class="line">&#125;</span><br><span class="line">while true ;do</span><br><span class="line">read -p "Please Choose a Disk :" chof</span><br><span class="line">case $chof in</span><br><span class="line">/dev/[sh]d[a-z])</span><br><span class="line">        [  -e $chof ] &amp;&amp; break || continue ;;</span><br><span class="line">quit)</span><br><span class="line">        exit 5;;</span><br><span class="line">*)</span><br><span class="line">        continue;;</span><br><span class="line">esac</span><br><span class="line">done</span><br><span class="line">fdisk -l $chof</span><br><span class="line">while true; do</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#############################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">       this will distory all your data!!    <span class="comment">#</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">                BE CAREFUL!!                <span class="comment">#</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">             yes|y) <span class="built_in">continue</span>                <span class="comment">#</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">              no|no ) stop                  <span class="comment">#</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#############################################</span></span></span><br><span class="line">EOF</span><br><span class="line">read -p "Enter Your Choice &#123;yes|no&#125;: " chos</span><br><span class="line">case $chos in</span><br><span class="line">yes|y)</span><br><span class="line">        Mount</span><br><span class="line">        diskpart</span><br><span class="line">        break ;;</span><br><span class="line">no|n)</span><br><span class="line">        exit 3 ;;</span><br><span class="line">*)</span><br><span class="line">        echo "You must give a choice"</span><br><span class="line">        continue  ;;</span><br><span class="line">esac</span><br><span class="line">done</span><br><span class="line">[ ! -d /mnt/boot ] &amp;&amp; mkdir /mnt/boot</span><br><span class="line">[ ! -d /mnt/sysroot ] &amp;&amp; mkdir /mnt/sysroot</span><br><span class="line">for j in &#123;1..3&#125;;do</span><br><span class="line">        if [ $j -eq 1 ]; then</span><br><span class="line">                mke2fs -t ext4 $chof$j</span><br><span class="line">                mount $chof$j /mnt/boot</span><br><span class="line">        elif [ $j -eq 2 ]; then</span><br><span class="line">                mkswap $chof$j</span><br><span class="line">        else</span><br><span class="line">                mke2fs -t ext4 $chof$j</span><br><span class="line">                mount $chof$j /mnt/sysroot</span><br><span class="line">        fi</span><br><span class="line">done</span><br><span class="line">echo "partision successfully"</span><br></pre></td></tr></table></figure>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/li-bo-2-25">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        

        

        
        <li>
            <a target="_blank" href="https://github.com/liboo0731">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://www.cnblogs.com/liboo/">H2K1R~ACE_博客园</a></span>
        <span>/</span>
        
        <span><a href="https://blog.csdn.net/weixin_40108079">H2K1E~ACE_CSDN</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
        */
        if( '' || '')
        var disqus_config = function () {
            this.page.url = '';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://airclouds-blog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>

</html>
