<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="李博的博客">
    <meta name="keyword" content="striveliboo">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        【python】爬虫简单实践 - Liboo的博客 | Liboo&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Internet of Everything, Everywhere. </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg">
        </div>
        <div class="name">
            <i>H2K1E~ACE</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li>
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li>
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#豆瓣"><span class="toc-text">豆瓣</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#新闻"><span class="toc-text">新闻</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RPM源下载"><span class="toc-text">RPM源下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#静态网页"><span class="toc-text">静态网页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图片获取"><span class="toc-text">图片获取</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input">
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> Internet of Everything, Everywhere. </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        【python】爬虫简单实践
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2017-10-24 16:35:22</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#python" title="python">python</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>

    </div>
    <div class="post-content ">
        <h3 id="豆瓣"><a href="#豆瓣" class="headerlink" title="豆瓣"></a>豆瓣</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'utf8'</span>)</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"></span><br><span class="line"><span class="comment">#得到页面全部内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">askURL</span><span class="params">(url)</span>:</span></span><br><span class="line">    request = urllib2.Request(url)<span class="comment">#发送请求</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = urllib2.urlopen(request)<span class="comment">#取得响应</span></span><br><span class="line">        html= response.read()<span class="comment">#获取网页内容</span></span><br><span class="line">        <span class="comment">#print html</span></span><br><span class="line">    <span class="keyword">except</span> urllib2.URLError, e:</span><br><span class="line">        <span class="keyword">if</span> hasattr(e,<span class="string">"code"</span>):</span><br><span class="line">            <span class="keyword">print</span> e.code</span><br><span class="line">        <span class="keyword">if</span> hasattr(e,<span class="string">"reason"</span>):</span><br><span class="line">            <span class="keyword">print</span> e.reason</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取相关内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getData</span><span class="params">(baseurl)</span>:</span></span><br><span class="line">    <span class="comment">#找到评论标题</span></span><br><span class="line">    pattern_title = re.compile(<span class="string">r'&lt;a class="".+title="(.+)"'</span>)</span><br><span class="line">    <span class="comment">#找到评论全文链接</span></span><br><span class="line">    pattern_link = re.compile(<span class="string">r'&lt;a class="".+href="(.+review.*?)"'</span>)</span><br><span class="line">    <span class="comment">#找到作者</span></span><br><span class="line">    pattern_author = re.compile(<span class="string">r'&lt;a.+people.+"&gt;(.+)&lt;/a&gt;'</span>)</span><br><span class="line">    <span class="comment">#找到评论的影片和影评详情链接</span></span><br><span class="line">    pattern_subject_link = re.compile(<span class="string">r'&lt;a href="(.+subject.+)" title="(.+)"&gt;'</span>)</span><br><span class="line">    <span class="comment">#找到推荐等级</span></span><br><span class="line">    pattern_star=re.compile(<span class="string">r'&lt;span class="allstar\d+" title="(.+)"&gt;&lt;/span&gt;'</span>)</span><br><span class="line">    <span class="comment">#找到回应数</span></span><br><span class="line">    pattern_response=re.compile(<span class="string">r'&lt;span class=""&gt;\((\d+)回应\)&lt;/span&gt;'</span>)</span><br><span class="line">    <span class="comment">#找到有用数</span></span><br><span class="line">    pattern_use=re.compile(<span class="string">r'&lt;em id="ucount\d+u"&gt;(\d+)&lt;/em&gt;'</span>)</span><br><span class="line">    remove=re.compile(<span class="string">r'&lt;.+?&gt;'</span>)<span class="comment">#去除标签</span></span><br><span class="line">    datalist=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):<span class="comment">#总共5页</span></span><br><span class="line">        url=baseurl+str(i*<span class="number">10</span>)<span class="comment">#更新url</span></span><br><span class="line">        html=askURL(url)</span><br><span class="line">        soup = BeautifulSoup(html)</span><br><span class="line">        <span class="comment">#找到每一个影评项</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> soup.find_all(<span class="string">'ul'</span>,class_=<span class="string">'tlst clearfix'</span>):</span><br><span class="line">            data=[]</span><br><span class="line">            item=str(item)<span class="comment">#转换成字符串</span></span><br><span class="line">            <span class="comment">#print item</span></span><br><span class="line">            title = re.findall(pattern_title,item)[<span class="number">0</span>]</span><br><span class="line">            <span class="comment">#print title</span></span><br><span class="line">            reviewlink=re.findall(pattern_link,item)[<span class="number">0</span>]</span><br><span class="line">            data.append(title)<span class="comment">#添加标题</span></span><br><span class="line">            author=re.findall(pattern_author, item)[<span class="number">0</span>]</span><br><span class="line">            data.append(author)<span class="comment">#添加作者</span></span><br><span class="line">            list_subject_link = re.findall(pattern_subject_link, item)[<span class="number">0</span>]</span><br><span class="line">            moviename=list_subject_link[<span class="number">1</span>]</span><br><span class="line">            movielink=list_subject_link[<span class="number">0</span>]</span><br><span class="line">            data.append(moviename)<span class="comment">#添加片名</span></span><br><span class="line">            data.append(movielink)<span class="comment">#添加影片链接</span></span><br><span class="line">            star=re.findall(pattern_star,item)[<span class="number">0</span>]</span><br><span class="line">            data.append(star)<span class="comment">#添加推荐等级</span></span><br><span class="line">            response=re.findall(pattern_response,item)</span><br><span class="line">            <span class="comment">#回应数可能为0，就找不到</span></span><br><span class="line">            <span class="keyword">if</span>(len(response)!=<span class="number">0</span>):</span><br><span class="line">                response=response[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                response=<span class="number">0</span></span><br><span class="line">            data.append(response)<span class="comment">#添加回应数</span></span><br><span class="line">            data.append(reviewlink)<span class="comment">#添加评论正文链接</span></span><br><span class="line">            content=askURL(reviewlink)</span><br><span class="line">            use=re.findall(pattern_use,content)</span><br><span class="line">            <span class="comment">#有用数可能为0，就找不到</span></span><br><span class="line">            <span class="keyword">if</span> len(use)!=<span class="number">0</span>:</span><br><span class="line">                use=use[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                use=<span class="number">0</span></span><br><span class="line">            content=BeautifulSoup(content)</span><br><span class="line">            desc=content.find_all(<span class="string">'div'</span>,id=<span class="string">'link-report'</span>)[<span class="number">0</span>]</span><br><span class="line">            desc=re.sub(remove,<span class="string">''</span>,str(desc))<span class="comment">#去掉标签</span></span><br><span class="line">            data.append(desc)<span class="comment">#添加评论正文</span></span><br><span class="line">            data.append(use)<span class="comment">#添加有用数</span></span><br><span class="line">            datalist.append(data)</span><br><span class="line">    <span class="keyword">return</span> datalist</span><br><span class="line"></span><br><span class="line"><span class="comment">#将相关数据写入excel中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">saveData</span><span class="params">(datalist,savepath)</span>:</span></span><br><span class="line">    book=xlwt.Workbook(encoding=<span class="string">'utf-8'</span>,style_compression=<span class="number">0</span>)</span><br><span class="line">    sheet=book.add_sheet(<span class="string">'豆瓣最受欢迎影评'</span>,cell_overwrite_ok=<span class="literal">True</span>)</span><br><span class="line">    col=(<span class="string">'标题'</span>,<span class="string">'作者'</span>,<span class="string">'影片名'</span>,<span class="string">'影片详情链接'</span>,<span class="string">'推荐级'</span>,<span class="string">'回应数'</span>,<span class="string">'影评链接'</span>,<span class="string">'影评'</span>,<span class="string">'有用数'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">        sheet.write(<span class="number">0</span>,i,col[i])<span class="comment">#列名</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):<span class="comment">#总共50条影评</span></span><br><span class="line">        data=datalist[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">9</span>):</span><br><span class="line">            sheet.write(i+<span class="number">1</span>,j,data[j])<span class="comment">#数据</span></span><br><span class="line">    book.save(savepath)<span class="comment">#保存</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    baseurl=<span class="string">'http://movie.douban.com/review/best/?start='</span></span><br><span class="line">    datalist=getData(baseurl)</span><br><span class="line">    savapath=<span class="string">u'豆瓣最受欢迎影评.xlsx'</span></span><br><span class="line">    saveData(datalist,savapath)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h3 id="新闻"><a href="#新闻" class="headerlink" title="新闻"></a>新闻</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#得到页面全部内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">askURL</span><span class="params">(url)</span>:</span></span><br><span class="line">    request = urllib2.Request(url)<span class="comment">#发送请求</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = urllib2.urlopen(request)<span class="comment">#取得响应</span></span><br><span class="line">        html= response.read()<span class="comment">#获取网页内容</span></span><br><span class="line">        <span class="comment">#print html</span></span><br><span class="line">        html=html.decode(<span class="string">'gbk'</span>,<span class="string">'ignore'</span>)<span class="comment">#将gbk编码转为unicode编码</span></span><br><span class="line">        html=html.encode(<span class="string">'utf-8'</span>,<span class="string">'ignore'</span>)<span class="comment">#将unicode编码转为utf-8编码</span></span><br><span class="line">    <span class="keyword">except</span> urllib2.URLError, e:</span><br><span class="line">        <span class="keyword">if</span> hasattr(e,<span class="string">"code"</span>):</span><br><span class="line">            <span class="keyword">print</span> e.code</span><br><span class="line">        <span class="keyword">if</span> hasattr(e,<span class="string">"reason"</span>):</span><br><span class="line">            <span class="keyword">print</span> e.reason</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="comment">#得到正文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getContent</span><span class="params">(url)</span>:</span></span><br><span class="line">    html=askURL(url)</span><br><span class="line">    text=<span class="string">''</span></span><br><span class="line">    <span class="comment">#找到新闻主体所在的标签</span></span><br><span class="line">    findDiv=re.compile(<span class="string">r'&lt;div class="left_zw" style="position:relative"&gt;'</span></span><br><span class="line">                       <span class="string">r'(.*)&lt;div id="function_code_page"&gt;'</span>,re.S)</span><br><span class="line">    div=re.findall(findDiv,html)</span><br><span class="line">    <span class="keyword">if</span> len(div)!=<span class="number">0</span>:</span><br><span class="line">        content=div[<span class="number">0</span>]</span><br><span class="line">        labels=re.compile(<span class="string">r'[/]*&lt;.*?&gt;'</span>,re.S)</span><br><span class="line">        text=re.sub(labels,<span class="string">''</span>,content)<span class="comment">#去掉各种标签</span></span><br><span class="line">        text=re.sub(<span class="string">r'\s|中新社.*?电|\(完\)|\(记者.*?\)'</span>,<span class="string">''</span>,text)<span class="comment">#去掉空行和换行符,无关内容</span></span><br><span class="line">        text=re.sub(<span class="string">r'　　'</span>,<span class="string">'\n'</span>,text)<span class="comment">#将缩进符替换成换行符</span></span><br><span class="line">        <span class="comment">#print text</span></span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="comment">#根据类别按顺序命名文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">saveFile</span><span class="params">(labelName,date,fileNum)</span>:</span></span><br><span class="line">    dirname=<span class="string">"news"</span></span><br><span class="line">    <span class="comment">#若目录不存在，就新建</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(dirname)):</span><br><span class="line">        os.mkdir(dirname)</span><br><span class="line">    labelName=labelName.encode(<span class="string">'gbk'</span>,<span class="string">'ignore'</span>)</span><br><span class="line">    labelpath=dirname+<span class="string">'\\'</span>+labelName</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(labelpath)):</span><br><span class="line">        os.mkdir(labelpath)</span><br><span class="line">    path=labelpath+<span class="string">"\\"</span>+date+<span class="string">"-0"</span>+str(fileNum)+<span class="string">".txt"</span><span class="comment">#w文本保存路径</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"正在下载"</span>+path</span><br><span class="line">    <span class="comment">#path=path.encode('gbk','utf-8')#转换编码</span></span><br><span class="line">    f=open(path,<span class="string">'w+'</span>)</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="comment">#得到正文的URL，读取正文，并保存</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getURL</span><span class="params">(nurl,labelName)</span>:</span></span><br><span class="line">    html=askURL(nurl)</span><br><span class="line">    findDiv=re.compile(<span class="string">r'&lt;div class="dd_lm"&gt;.*&lt;/div&gt;'</span>)</span><br><span class="line">    findTime=re.compile(<span class="string">r'&lt;div class="dd_time"&gt;(.*)&lt;/div&gt;'</span>)</span><br><span class="line">    findTitle=re.compile(<span class="string">r'&lt;div class="dd_bt"&gt;&lt;a href="http://www.chinanews.com/.*\.shtml"&gt;(.*)&lt;/a&gt;&lt;/div&gt;'</span>)</span><br><span class="line">    findURL=re.compile(<span class="string">r'&lt;div class="dd_bt"&gt;&lt;a href="(http://www.chinanews.com/.*\.shtml)"&gt;.*&lt;/a&gt;&lt;/div&gt;'</span>)</span><br><span class="line">    findLabel=re.compile(<span class="string">r'&lt;div class="dd_lm"&gt;\[&lt;a href=http://www.chinanews.com/.*\.shtml&gt;(.*)&lt;/a&gt;\]&lt;/div&gt;'</span>)</span><br><span class="line">    fileNum=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> info <span class="keyword">in</span> re.findall(findDiv,html):</span><br><span class="line">        <span class="comment">#print info</span></span><br><span class="line">        time=re.findall(findTime,info)[<span class="number">0</span>]</span><br><span class="line">        date=re.findall(<span class="string">r'\d?-\d*'</span>,time)[<span class="number">0</span>]<span class="comment">#获取新闻发布日期</span></span><br><span class="line">        title=re.findall(findTitle,info)[<span class="number">0</span>]</span><br><span class="line">        url=re.findall(findURL,info)[<span class="number">0</span>]<span class="comment">#获取新闻正文的链接</span></span><br><span class="line">        label=re.findall(findLabel,info)[<span class="number">0</span>]<span class="comment">#获取新闻所属类别</span></span><br><span class="line">        <span class="keyword">if</span>(label==<span class="string">"I&amp;nbsp;&amp;nbsp;T"</span>):<span class="comment">#网页为I&amp;nbsp;&amp;nbsp;T</span></span><br><span class="line">            label=<span class="string">"IT"</span></span><br><span class="line">        <span class="keyword">if</span>(labelName==label):</span><br><span class="line">            text=getContent(url)</span><br><span class="line">            <span class="comment">#如果新闻内容长度大于1000，保存新闻标题和正文</span></span><br><span class="line">            <span class="keyword">if</span>(len(text)&gt;<span class="number">1000</span>):</span><br><span class="line">                fileNum=fileNum+<span class="number">1</span></span><br><span class="line">                f=saveFile(labelName,date,fileNum)</span><br><span class="line">                f.write(title)</span><br><span class="line">                f.write(text)</span><br><span class="line">                f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#抓取新闻标题、类别、发布时间、url，并建立相应的文件，存到相应的类别文件夹中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNews</span><span class="params">(url,begin_page,end_page,labelName)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(begin_page, end_page+<span class="number">1</span>):</span><br><span class="line">        nurl=url+str(i)+<span class="string">".html"</span></span><br><span class="line">        <span class="comment">#print nurl</span></span><br><span class="line">        <span class="comment">#获取网页内容</span></span><br><span class="line">        getURL(nurl,labelName)</span><br><span class="line"></span><br><span class="line"><span class="comment">#接收输入类别、起始页数、终止页数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url=<span class="string">'http://www.chinanews.com/scroll-news/news'</span></span><br><span class="line">    ch=int(raw_input(<span class="string">u'请输入类别的对应的数字（IT=1、财经=2、地方=3、国际=4、国内=5、健康=6、军事=7、'</span></span><br><span class="line">                 <span class="string">u'社会=8、体育=9、文化=10），输入-1退出，输入0表示全选：\n'</span>))</span><br><span class="line">    labels=(<span class="string">'IT'</span>,<span class="string">'财经'</span>,<span class="string">'地方'</span>,<span class="string">"国际"</span>,<span class="string">"国内"</span>,<span class="string">"健康"</span>,<span class="string">"军事"</span>,<span class="string">"社会"</span>,<span class="string">"体育"</span>,<span class="string">"文化"</span>)</span><br><span class="line">    <span class="keyword">while</span>(ch!=<span class="number">-1</span>):</span><br><span class="line">        begin_page = int(raw_input(<span class="string">u'请输入开始的页数(1,)：\n'</span>))</span><br><span class="line">        end_page = int(raw_input(<span class="string">u'请输入终点的页数(1,)：\n'</span>))</span><br><span class="line">        <span class="keyword">if</span>(ch&gt;=<span class="number">1</span> <span class="keyword">and</span> ch&lt;=<span class="number">10</span>):</span><br><span class="line">            getNews(url,begin_page,end_page,labels[ch<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">elif</span>(ch==<span class="number">0</span>):</span><br><span class="line">            <span class="keyword">for</span> label <span class="keyword">in</span> labels:</span><br><span class="line">                getNews(url,begin_page,end_page,label)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"输入错误，请重新输入！"</span></span><br><span class="line">        ch=int(raw_input(<span class="string">u'请输入类别的对应的数字（IT=1、财经=2、地方=3、国际=4、国内=5、健康=6、军事=7、'</span></span><br><span class="line">                         <span class="string">u'社会=8、体育=9、文化=10），输入-1退出，输入0表示全选：\n'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#调用主函数</span></span><br><span class="line"><span class="comment">#一页有125条新闻</span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h3 id="RPM源下载"><a href="#RPM源下载" class="headerlink" title="RPM源下载"></a>RPM源下载</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"The Most Basic Download\n"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtml</span><span class="params">(url)</span>:</span></span><br><span class="line">    page = urllib.urlopen(url)</span><br><span class="line">    html = page.read()</span><br><span class="line">    <span class="keyword">print</span> html</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImg</span><span class="params">(html)</span>:</span></span><br><span class="line">    reg = <span class="string">r'href="(.*?\.rpm)"'</span> <span class="comment">#匹配的正则表达式</span></span><br><span class="line">    imgre = re.compile(reg)</span><br><span class="line">    imglist = re.findall(imgre,html)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> imgurl <span class="keyword">in</span> imglist:</span><br><span class="line">        name = imgurl[:<span class="number">-4</span>]</span><br><span class="line">        <span class="keyword">print</span> name</span><br><span class="line">        httpurl = <span class="string">'http://mirrors.163.com/centos/7/os/x86_64/Packages/'</span> + imgurl</span><br><span class="line">        <span class="keyword">print</span>  httpurl</span><br><span class="line">        urllib.urlretrieve(httpurl,<span class="string">'%s.jpg'</span> % name) <span class="comment">#下载的内容，并顺序命名</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url =<span class="string">"http://mirrors.163.com/centos/7/os/x86_64/Packages/"</span></span><br><span class="line">html = getHtml(url)</span><br><span class="line">getImg(html)</span><br><span class="line"></span><br><span class="line"><span class="comment">#http://www.nvsheng.com/mm/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">多网址下载改进</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtml</span><span class="params">(url)</span>:</span></span><br><span class="line">    page = urllib.urlopen(url)</span><br><span class="line">    html = page.read()</span><br><span class="line">    getImg(html)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImg</span><span class="params">(html)</span>:</span></span><br><span class="line">    reg = <span class="string">r'href="(.*?\.rpm)"'</span> <span class="comment">#匹配的正则表达式</span></span><br><span class="line">    imgre = re.compile(reg)</span><br><span class="line">    imglist = re.findall(imgre,html)</span><br><span class="line">    file1 = open(<span class="string">"rpm.txt"</span>, <span class="string">"w"</span>)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> imgurl <span class="keyword">in</span> imglist:</span><br><span class="line">        <span class="keyword">print</span> imgurl</span><br><span class="line">        x=x+<span class="number">1</span></span><br><span class="line">        file1.write(<span class="string">'http://mirrors.163.com/centos/7/os/x86_64/Packages/'</span> + imgurl + <span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">print</span> x</span><br><span class="line">    file1.close()</span><br><span class="line"></span><br><span class="line">url =<span class="string">"http://mirrors.163.com/centos/7/os/x86_64/Packages/"</span></span><br><span class="line">html = getHtml(url)</span><br><span class="line">getImg(html)</span><br></pre></td></tr></table></figure>
<h3 id="静态网页"><a href="#静态网页" class="headerlink" title="静态网页"></a>静态网页</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtml</span><span class="params">(url)</span>:</span></span><br><span class="line">    page = urllib.urlopen(url)</span><br><span class="line">    html = page.read()</span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImg</span><span class="params">(html)</span>:</span></span><br><span class="line">    reg = <span class="string">r'src="(.*?\.jpg)"'</span></span><br><span class="line">    imgre = re.compile(reg)</span><br><span class="line">    imglist = re.findall(imgre,html)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> imgurl <span class="keyword">in</span> imglist:</span><br><span class="line">        <span class="keyword">print</span> imgurl</span><br><span class="line">        urllib.urlretrieve(imgurl,<span class="string">'%s.jpg'</span> % x)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=<span class="string">""</span></span><br><span class="line">html = getHtml(url)</span><br><span class="line">getImg(html)</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImg</span><span class="params">(html)</span>:</span></span><br><span class="line">    reg = <span class="string">r'src="(.*?\.jpg)"'</span> <span class="comment">#匹配的正则表达式</span></span><br><span class="line">    imgre = re.compile(reg)</span><br><span class="line">    imglist = re.findall(imgre,html)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> imgurl <span class="keyword">in</span> imglist:</span><br><span class="line">        name1 = imgurl[:<span class="number">-4</span>]</span><br><span class="line">        <span class="keyword">print</span> name1</span><br><span class="line">        name2 = name1.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">print</span> name2</span><br><span class="line">        urllib.urlretrieve(imgurl,<span class="string">'%s.jpg'</span> % name2)</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> urllib2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHtml</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        respHtml = urllib2.urlopen(url).read();</span><br><span class="line">    <span class="keyword">except</span> urllib2.URLError, e:</span><br><span class="line">        <span class="keyword">if</span> hasattr(e, <span class="string">"reason"</span>):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Failed to reach the server"</span></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"The reason:"</span>, e.reason</span><br><span class="line">        <span class="keyword">elif</span> hasattr(e, <span class="string">"code"</span>):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"The server couldn't fulfill the request"</span></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Error code:"</span>, e.code</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Return content:"</span>, e.read()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> respHtml</span><br></pre></td></tr></table></figure>
<h3 id="图片获取"><a href="#图片获取" class="headerlink" title="图片获取"></a>图片获取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:gbk</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">STD_INPUT_HANDLE = <span class="number">-10</span></span><br><span class="line">STD_OUTPUT_HANDLE = <span class="number">-11</span></span><br><span class="line">STD_ERROR_HANDLE = <span class="number">-12</span></span><br><span class="line"></span><br><span class="line">FOREGROUND_BLACK = <span class="number">0x0</span></span><br><span class="line">FOREGROUND_BLUE = <span class="number">0x01</span>  <span class="comment"># text color contains blue.</span></span><br><span class="line">FOREGROUND_GREEN = <span class="number">0x02</span>  <span class="comment"># text color contains green.</span></span><br><span class="line">FOREGROUND_RED = <span class="number">0x04</span>  <span class="comment"># text color contains red.</span></span><br><span class="line">FOREGROUND_INTENSITY = <span class="number">0x08</span>  <span class="comment"># text color is intensified.</span></span><br><span class="line"></span><br><span class="line">BACKGROUND_BLUE = <span class="number">0x10</span>  <span class="comment"># background color contains blue.</span></span><br><span class="line">BACKGROUND_GREEN = <span class="number">0x20</span>  <span class="comment"># background color contains green.</span></span><br><span class="line">BACKGROUND_RED = <span class="number">0x40</span>  <span class="comment"># background color contains red.</span></span><br><span class="line">BACKGROUND_INTENSITY = <span class="number">0x80</span>  <span class="comment"># background color is intensified.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面这一大段都是在设置前景色和背景色，其实可以用数字直接设置，我的代码直接用数字设置颜色</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Color</span>:</span></span><br><span class="line">    std_out_handle = ctypes.windll.kernel32.GetStdHandle(STD_OUTPUT_HANDLE)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_cmd_color</span><span class="params">(self, color, handle=std_out_handle)</span>:</span></span><br><span class="line">        bool = ctypes.windll.kernel32.SetConsoleTextAttribute(handle, color)</span><br><span class="line">        <span class="keyword">return</span> bool</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reset_color</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.set_cmd_color(FOREGROUND_RED | FOREGROUND_GREEN | FOREGROUND_BLUE | FOREGROUND_INTENSITY)</span><br><span class="line">        <span class="comment"># 初始化颜色为黑色背景，纯白色字，CMD默认是灰色字体的</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_red_text</span><span class="params">(self, print_text)</span>:</span></span><br><span class="line">        self.set_cmd_color(<span class="number">4</span> | <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">print</span> print_text</span><br><span class="line">        self.reset_color()</span><br><span class="line">        <span class="comment"># 红色字体</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_green_text</span><span class="params">(self, print_text)</span>:</span></span><br><span class="line">        self.set_cmd_color(FOREGROUND_GREEN | FOREGROUND_INTENSITY)</span><br><span class="line">        c = raw_input(print_text)</span><br><span class="line">        self.reset_color()</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">        <span class="comment"># 绿色字体。实现的是，让用户输入的字体是绿色的，记得返回函数值。</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_yellow_text</span><span class="params">(self, print_text)</span>:</span></span><br><span class="line">        self.set_cmd_color(<span class="number">6</span> | <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">print</span> print_text</span><br><span class="line">        self.reset_color()</span><br><span class="line">        <span class="comment"># 黄色字体</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_blue_text</span><span class="params">(self, print_text)</span>:</span></span><br><span class="line">        self.set_cmd_color(<span class="number">1</span> | <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">print</span> print_text</span><br><span class="line">        self.reset_color()</span><br><span class="line">        <span class="comment"># 蓝色字体</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clr = Color()</span><br><span class="line">clr.set_cmd_color(FOREGROUND_RED | FOREGROUND_GREEN | FOREGROUND_BLUE | FOREGROUND_INTENSITY)</span><br><span class="line">clr.print_yellow_text(<span class="string">'*'</span>*<span class="number">66</span>)</span><br><span class="line">clr.print_yellow_text(<span class="string">"*m.mm131.com"</span>)</span><br><span class="line">clr.print_yellow_text(<span class="string">"*Site examples:\thttp://img1.mm131.com/pic/2721/1.jpg"</span>)</span><br><span class="line">clr.print_yellow_text(<span class="string">"*You can enter multiple IDs and Pages,Separated by ' '."</span>)</span><br><span class="line">clr.print_yellow_text(<span class="string">"If you enter nothing, the program will end."</span>)</span><br><span class="line">clr.print_yellow_text(<span class="string">'*'</span>*<span class="number">66</span>+<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">modeUrl = <span class="string">"http://img1.mm131.com/pic/"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span><span class="params">(modeUrl,id,end)</span>:</span></span><br><span class="line">    file1 = open(<span class="string">"resUrl.txt"</span>,<span class="string">"a"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,int(end)+<span class="number">1</span>):</span><br><span class="line">        url = modeUrl + id + <span class="string">'/'</span> + str(i) +<span class="string">".jpg\n"</span></span><br><span class="line">        <span class="keyword">print</span> url</span><br><span class="line">        file1.write(url)</span><br><span class="line">    file1.write(<span class="string">'\n'</span>)</span><br><span class="line">    file1.close()</span><br><span class="line">    clr.print_yellow_text(<span class="string">"Successful!\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    ids = clr.print_green_text(<span class="string">"Please enter the ID of the page you want to download:\n"</span>)</span><br><span class="line">    ends = clr.print_green_text(<span class="string">"Please enter the total number of pages:\n"</span>)</span><br><span class="line">    <span class="keyword">while</span>(ids!=<span class="string">''</span>):</span><br><span class="line">        idlist = ids.split(<span class="string">' '</span>)</span><br><span class="line">        endlist = ends.split(<span class="string">' '</span>)</span><br><span class="line">        <span class="keyword">for</span> (id,end) <span class="keyword">in</span> zip(idlist,endlist):</span><br><span class="line">            <span class="keyword">if</span>(int(id)&gt;<span class="number">0</span>):</span><br><span class="line">                getUrl(modeUrl,id,end)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                clr.print_red_text(<span class="string">"\nInput error,please enter again!\n"</span>)</span><br><span class="line">        ids = clr.print_green_text(<span class="string">"Please enter the ID of the page you want to download:\n"</span>)</span><br><span class="line">        ends = clr.print_green_text(<span class="string">"Please enter the total number of pages:\n"</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br><span class="line"></span><br><span class="line"><span class="comment">#最新地址到：http://img1.mm131.com/pic/2721/0.jpg  2016-10-29</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding( <span class="string">"utf-8"</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取导航栏</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNavUrls</span><span class="params">(url)</span>:</span></span><br><span class="line">    browser.get(url)</span><br><span class="line">    nav_xpath = browser.find_element_by_xpath(<span class="string">"/html/body/div[4]"</span>)</span><br><span class="line">    nav_atags = nav_xpath.find_elements_by_tag_name(<span class="string">"a"</span>)</span><br><span class="line">    navs = []</span><br><span class="line">    <span class="keyword">for</span> nav_atag <span class="keyword">in</span> nav_atags:</span><br><span class="line">        nav = nav_atag.get_attribute(<span class="string">"href"</span>)</span><br><span class="line">        navs.append(nav)</span><br><span class="line">    <span class="keyword">return</span> navs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取总页数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAllPages</span><span class="params">(navurl)</span>:</span></span><br><span class="line">    browser.get(navurl)</span><br><span class="line">    endPageUrl = browser.find_element_by_link_text(<span class="string">"末页"</span>).get_attribute(<span class="string">"href"</span>)</span><br><span class="line">    browser.get(endPageUrl)</span><br><span class="line">    page =  browser.find_element_by_class_name(<span class="string">"page_now"</span>).text</span><br><span class="line">    <span class="keyword">return</span> int(page)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取模块具体内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getModeUrls</span><span class="params">(navs)</span>:</span></span><br><span class="line">    modeUrls = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> nav <span class="keyword">in</span> navs:</span><br><span class="line">        <span class="keyword">print</span> nav</span><br><span class="line">        nums = range(getAllPages(nav))</span><br><span class="line">        firstPage = nav</span><br><span class="line">        pics = &#123;&#125;</span><br><span class="line">        pages = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> nextPage <span class="keyword">in</span> nums:</span><br><span class="line">            <span class="keyword">print</span> nextPage</span><br><span class="line">            browser.get(firstPage)</span><br><span class="line">            mode_xpath = browser.find_element_by_xpath(<span class="string">"/html/body/div[5]/dl"</span>)</span><br><span class="line">            mode_imgs = mode_xpath.find_elements_by_tag_name(<span class="string">"img"</span>)</span><br><span class="line">            <span class="keyword">for</span> mode_img <span class="keyword">in</span> mode_imgs:</span><br><span class="line">                pics[mode_img.get_attribute(<span class="string">"alt"</span>)] = mode_img.get_attribute(<span class="string">"src"</span>)</span><br><span class="line">            pages[nextPage + <span class="number">1</span>] = pics</span><br><span class="line">            <span class="keyword">if</span> nextPage &lt; len(nums)<span class="number">-1</span>:</span><br><span class="line">                firstPage = browser.find_element_by_link_text(<span class="string">"下一页"</span>).get_attribute(<span class="string">"href"</span>)</span><br><span class="line">        modeUrls[nav] = pages</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'mm.json'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(json.dumps(modeUrls, encoding=<span class="string">'UTF-8'</span>, ensure_ascii=<span class="literal">False</span>))</span><br><span class="line">    <span class="keyword">return</span> json.dumps(modeUrls, encoding=<span class="string">'UTF-8'</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> time.ctime()</span><br><span class="line">browser = webdriver.PhantomJS()</span><br><span class="line">url = <span class="string">"http://www.mm131.com/"</span></span><br><span class="line">navs = getNavUrls(url)[<span class="number">1</span>:]</span><br><span class="line"><span class="keyword">print</span> navs</span><br><span class="line"><span class="keyword">print</span> getModeUrls(navs)</span><br><span class="line">browser.close()</span><br><span class="line"><span class="keyword">print</span> time.ctime()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding( <span class="string">"utf-8"</span> )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取导航栏</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNavUrls</span><span class="params">(url)</span>:</span></span><br><span class="line">    browser.get(url)</span><br><span class="line">    nav_xpath = browser.find_element_by_xpath(<span class="string">"/html/body/div[4]"</span>)</span><br><span class="line">    nav_atags = nav_xpath.find_elements_by_tag_name(<span class="string">"a"</span>)</span><br><span class="line">    navs = []</span><br><span class="line">    <span class="keyword">for</span> nav_atag <span class="keyword">in</span> nav_atags:</span><br><span class="line">        nav = nav_atag.get_attribute(<span class="string">"href"</span>)</span><br><span class="line">        navs.append(nav)</span><br><span class="line">    <span class="keyword">return</span> navs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取概览的总页数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAllPages</span><span class="params">(navurl)</span>:</span></span><br><span class="line">    browser = webdriver.PhantomJS()</span><br><span class="line">    browser.get(navurl)</span><br><span class="line">    endPageUrl = browser.find_element_by_link_text(<span class="string">"末页"</span>).get_attribute(<span class="string">"href"</span>)</span><br><span class="line">    browser.get(endPageUrl)</span><br><span class="line">    page =  browser.find_element_by_class_name(<span class="string">"page_now"</span>).text</span><br><span class="line">    <span class="keyword">return</span> int(page)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有概念图到json文件</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getModeUrls</span><span class="params">(navs)</span>:</span></span><br><span class="line">    modeUrls = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> nav <span class="keyword">in</span> navs:</span><br><span class="line">        <span class="keyword">print</span> nav</span><br><span class="line">        nums = range(getAllPages(nav))</span><br><span class="line">        firstPage = nav</span><br><span class="line">        pics = &#123;&#125;</span><br><span class="line">        pages = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> nextPage <span class="keyword">in</span> nums:</span><br><span class="line">            <span class="keyword">print</span> nextPage</span><br><span class="line">            browser.get(firstPage)</span><br><span class="line">            mode_xpath = browser.find_element_by_xpath(<span class="string">"/html/body/div[5]/dl"</span>)</span><br><span class="line">            mode_imgs = mode_xpath.find_elements_by_tag_name(<span class="string">"img"</span>)</span><br><span class="line">            <span class="keyword">for</span> mode_img <span class="keyword">in</span> mode_imgs:</span><br><span class="line">                pics[mode_img.get_attribute(<span class="string">"alt"</span>)] = mode_img.get_attribute(<span class="string">"src"</span>)</span><br><span class="line">            pages[nextPage + <span class="number">1</span>] = pics</span><br><span class="line">            <span class="keyword">if</span> nextPage &lt; len(nums)<span class="number">-1</span>:</span><br><span class="line">                firstPage = browser.find_element_by_link_text(<span class="string">"下一页"</span>).get_attribute(<span class="string">"href"</span>)</span><br><span class="line">        modeUrls[nav] = pages</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'mm.json'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(json.dumps(modeUrls, encoding=<span class="string">'UTF-8'</span>, ensure_ascii=<span class="literal">False</span>))</span><br><span class="line">    <span class="keyword">return</span> json.dumps(modeUrls, encoding=<span class="string">'UTF-8'</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有概览内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">viewAllModel</span><span class="params">(navs)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> nav <span class="keyword">in</span>  navs:</span><br><span class="line">        nums = getAllPages(nav)</span><br><span class="line">        browser.get(nav)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        num = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> num &lt; nums:</span><br><span class="line">            browser.find_element_by_link_text(<span class="string">"下一页"</span>).click()</span><br><span class="line">            time.sleep(<span class="number">3</span>)</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 顺序查看所有图片具体内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">viewAllDetailPics</span><span class="params">(navs)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> nav <span class="keyword">in</span> navs:</span><br><span class="line">        browser.get(nav)</span><br><span class="line">        durl = browser.find_element_by_xpath(<span class="string">"/html/body/div[5]/dl/dd[1]/a"</span>).get_attribute(<span class="string">"href"</span>)</span><br><span class="line">        browser.get(durl)</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 获取总页数</span></span><br><span class="line">            allPages = browser.find_element_by_xpath(<span class="string">"/html/body/div[6]/div[3]/span[1]"</span>).text</span><br><span class="line">            pages = int(re.findall(<span class="string">r"[0-9]&#123;1,9&#125;"</span>, allPages)[<span class="number">0</span>])</span><br><span class="line">            page = <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> page &lt; pages:</span><br><span class="line">                <span class="keyword">if</span> browser.find_element_by_link_text(<span class="string">"下一页"</span>):</span><br><span class="line">                    browser.find_element_by_link_text(<span class="string">"下一页"</span>).click()</span><br><span class="line">                    time.sleep(<span class="number">3</span>)</span><br><span class="line">                page += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> browser.find_element_by_xpath(<span class="string">"/html/body/div[6]/div[4]/a[1]"</span>).text != <span class="string">"没有了"</span>:</span><br><span class="line">                browser.find_element_by_xpath(<span class="string">"/html/body/div[6]/div[4]/a[1]"</span>).click()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个图片的具体信息</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">viewSingleDetailPic</span><span class="params">(url)</span>:</span></span><br><span class="line">    browser.get(url)</span><br><span class="line">    <span class="comment"># 获取总页数</span></span><br><span class="line">    allPages = browser.find_element_by_xpath(<span class="string">"/html/body/div[6]/div[3]/span[1]"</span>).text</span><br><span class="line">    pages = int(re.findall(<span class="string">r"[0-9]&#123;1,9&#125;"</span>, allPages)[<span class="number">0</span>])</span><br><span class="line">    page = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> page &lt; pages:</span><br><span class="line">        <span class="keyword">if</span> browser.find_element_by_link_text(<span class="string">"下一页"</span>):</span><br><span class="line">            browser.find_element_by_link_text(<span class="string">"下一页"</span>).click()</span><br><span class="line">        page += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 网页截图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">webScreenShotPics</span><span class="params">(url)</span>:</span></span><br><span class="line">    browser.get(url)</span><br><span class="line">    <span class="comment"># 获取总页数</span></span><br><span class="line">    allPages = browser.find_element_by_xpath(<span class="string">"/html/body/div[6]/div[3]/span[1]"</span>).text</span><br><span class="line">    pages = int(re.findall(<span class="string">r"[0-9]&#123;1,9&#125;"</span>, allPages)[<span class="number">0</span>])</span><br><span class="line">    page = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> page &lt; pages:</span><br><span class="line">        <span class="keyword">if</span> browser.find_element_by_link_text(<span class="string">"下一页"</span>):</span><br><span class="line">            browser.save_screenshot(str(page) + <span class="string">".png"</span>)</span><br><span class="line">            browser.find_element_by_link_text(<span class="string">"下一页"</span>).click()</span><br><span class="line">        page += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行程序</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    browser = webdriver.PhantomJS()</span><br><span class="line">    browser.maximize_window()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># url = "http://www.mm131.com/"</span></span><br><span class="line">    <span class="comment"># navs = getNavUrls(url)[1:]</span></span><br><span class="line">    <span class="comment"># print getModeUrls(navs)</span></span><br><span class="line">    <span class="comment"># viewAllModel(navs)</span></span><br><span class="line">    <span class="comment"># viewAllDetailPics(navs)</span></span><br><span class="line"></span><br><span class="line">    durl = <span class="string">"http://www.mm131.com/xinggan/3455.html"</span></span><br><span class="line">    <span class="comment"># viewSingleDetailPic(durl)</span></span><br><span class="line">    <span class="comment"># webScreenShotPics(durl)</span></span><br><span class="line"></span><br><span class="line">    browser.close()</span><br></pre></td></tr></table></figure>

        
        <br>
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/li-bo-2-25">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        

        

        
        <li>
            <a target="_blank" href="https://github.com/liboo0731">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://www.cnblogs.com/liboo/">H2K1R~ACE_博客园</a></span>
        <span>/</span>
        
        <span><a href="https://blog.csdn.net/weixin_40108079">H2K1E~ACE_CSDN</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    <script>
        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
        */
        if( '' || '')
        var disqus_config = function () {
            this.page.url = '';  // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };

        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://airclouds-blog.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>

</html>
